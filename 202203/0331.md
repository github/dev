# 分表联查

我们的recv_data表按日期进行分表，因此根据查询条件确定联查表

## 一、确定联查表

1. **获取数据库中所有recv_data相关的数据表**

``` en
    SELECT table_name FROM information_schema.tables WHERE table_schema='massdb' AND table_name like '%recv_data_%' order by table_name desc
```

2. **根据查询日期条件确定联查的表名列表，返回List\<string>**

## 二、联表查询

1. **联表数据量查询，需要组装查询sql如下（查询条件也需要组装）**
   * 查询总和
        >`SELECT (SELECT COUNT(id) FROM recv_data WHERE delete_flag = 0) + (SELECT COUNT(id) FROM recv_data_20220316 WHERE delete_flag = 0) AS count`

   * 分别根据表及查询条件，记录Map<表名, 数量>
        >`SELECT COUNT(id) FROM recv_data WHERE delete_flag = 0;`    
        >`SELECT COUNT(id) FROM recv_data_20220316 WHERE delete_flag = 0;`

    

2. **联表数据查询**
